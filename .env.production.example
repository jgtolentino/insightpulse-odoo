# InsightPulse AI Production Environment Variables
# Complete stack: Odoo 19 CE + Apache Superset + PostgreSQL + Redis + Nginx
# Copy this file to .env and fill in the values
# NEVER commit .env to version control

# ============================================================================
# Docker Image Configuration
# ============================================================================
ODOO_IMAGE=registry.digitalocean.com/insightpulse/odoo19-ce
ODOO_TAG=latest
SUPERSET_IMAGE=registry.digitalocean.com/insightpulse/superset
SUPERSET_TAG=latest

# ============================================================================
# PostgreSQL Database Configuration
# ============================================================================
POSTGRES_DB=odoo
POSTGRES_USER=postgres
POSTGRES_PASSWORD=CHANGE_ME_STRONG_PASSWORD_HERE
POSTGRES_MULTIPLE_DATABASES=odoo,superset

# PostgreSQL Performance Tuning (adjust based on available RAM)
# For 4GB RAM server:
POSTGRES_SHARED_BUFFERS=256MB
POSTGRES_EFFECTIVE_CACHE_SIZE=1GB
POSTGRES_WORK_MEM=16MB
POSTGRES_MAINTENANCE_WORK_MEM=128MB

# For 8GB RAM server, use:
# POSTGRES_SHARED_BUFFERS=512MB
# POSTGRES_EFFECTIVE_CACHE_SIZE=2GB
# POSTGRES_WORK_MEM=32MB
# POSTGRES_MAINTENANCE_WORK_MEM=256MB

# ============================================================================
# Odoo Configuration
# ============================================================================
ODOO_ADMIN_PASSWORD=CHANGE_ME_STRONG_ADMIN_PASSWORD_HERE

# Worker configuration (adjust based on CPU cores)
# Formula: (CPU cores * 2) + 1
# For 2 CPU cores:
ODOO_WORKERS=4
ODOO_MAX_CRON_THREADS=2
ODOO_DB_MAXCONN=64

# For 4 CPU cores, use:
# ODOO_WORKERS=8
# ODOO_MAX_CRON_THREADS=4
# ODOO_DB_MAXCONN=128

# Memory limits (in bytes)
# For 4GB RAM server:
ODOO_LIMIT_MEMORY_HARD=2684354560    # 2.5GB
ODOO_LIMIT_MEMORY_SOFT=2147483648    # 2GB

# For 8GB RAM server, use:
# ODOO_LIMIT_MEMORY_HARD=5368709120  # 5GB
# ODOO_LIMIT_MEMORY_SOFT=4294967296  # 4GB

# Timeouts (in seconds)
ODOO_LIMIT_TIME_CPU=120
ODOO_LIMIT_TIME_REAL=240
ODOO_LIMIT_TIME_REAL_CRON=3600

# Security
ODOO_DB_FILTER=^%d$          # Only allow database matching domain name
ODOO_PROXY_MODE=True
ODOO_LIST_DB=False           # Disable database listing for security

# ============================================================================
# Deployment Configuration (for CI/CD)
# ============================================================================
# Set these as GitHub Secrets, not in .env file:
# PROD_HOST=your.server.ip.address
# PROD_SSH_USER=deploy
# PROD_SSH_KEY=<your-ssh-private-key>
# PROD_COMPOSE_DIR=/opt/insightpulse

# ============================================================================
# Optional: SSL/TLS Configuration
# ============================================================================
# If you need custom SSL certificates for PostgreSQL:
# POSTGRES_SSL_CERT=/path/to/server.crt
# POSTGRES_SSL_KEY=/path/to/server.key

# ============================================================================
# Apache Superset Configuration
# ============================================================================
# CRITICAL: Generate a strong secret key with: openssl rand -base64 42
SUPERSET_SECRET_KEY=CHANGE_ME_GENERATE_WITH_OPENSSL

# Admin user for Superset
ADMIN_USERNAME=admin
ADMIN_PASSWORD=CHANGE_ME_ADMIN_PASSWORD
ADMIN_FIRSTNAME=Admin
ADMIN_LASTNAME=User
ADMIN_EMAIL=admin@insightpulseai.net

# Superset performance
SUPERSET_WORKERS=4
SUPERSET_THREADS=4
SUPERSET_TIMEOUT=120
SQLLAB_TIMEOUT=300
SQLLAB_ASYNC_TIME_LIMIT_SEC=600

# Load examples (set to 'yes' for development)
LOAD_EXAMPLES=no

# ============================================================================
# Redis Configuration
# ============================================================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=1

# Celery configuration
CELERY_BROKER_URL=redis://redis:6379/0
CELERY_RESULT_BACKEND=redis://redis:6379/0

# ============================================================================
# Email Configuration (for Superset reports and alerts)
# ============================================================================
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_MAIL_FROM=superset@insightpulseai.net
SMTP_STARTTLS=True
SMTP_SSL=False

# ============================================================================
# External Services
# ============================================================================
# Supabase configuration
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_KEY=your-supabase-anon-key

# Anthropic API (for AI features)
ANTHROPIC_API_KEY=sk-ant-your-api-key-here

# Mapbox API (for map visualizations in Superset)
MAPBOX_API_KEY=your-mapbox-api-key

# ============================================================================
# DigitalOcean Configuration (for CI/CD)
# ============================================================================
DIGITALOCEAN_TOKEN=your-digitalocean-api-token
PRODUCTION_DROPLET_ID=your-droplet-id
DROPLET_SSH_KEY=your-ssh-private-key

# ============================================================================
# Notion Integration (optional)
# ============================================================================
NOTION_API_KEY=your-notion-integration-token
INSIGHTPULSE_API_KEY=your-custom-api-key

# ============================================================================
# Backup Configuration
# ============================================================================
# Backup schedule (if using automated backups)
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
BACKUP_RETENTION_DAYS=7
BACKUP_S3_BUCKET=insightpulse-backups
AWS_ACCESS_KEY_ID=your-aws-key
AWS_SECRET_ACCESS_KEY=your-aws-secret
AWS_REGION=us-east-1
